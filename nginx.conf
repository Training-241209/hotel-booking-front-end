
# Process management block (optional but often used)
worker_processes auto;

# Required: events block (connection handling)
events {
    worker_connections 1024; # You can adjust this based on your expected traffic
}

http {
    server {
        listen 80;

        server_name localhost;

        # Serve the static files from the frontend
        root /usr/share/nginx/html;
        index index.html;

        underscores_in_headers on;


location /api/ {
    # Allow all headers to pass through
    proxy_pass http://backend.example.com;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;

    # Add CORS headers
    add_header Access-Control-Allow-Origin "*";
    add_header Access-Control-Allow-Methods "GET, POST, OPTIONS, DELETE, PUT, PATCH";
    add_header Access-Control-Allow-Headers "Authorization, Content-Type";
    add_header Access-Control-Allow-Credentials "true";

    # Handle preflight (OPTIONS) requests
    if ($request_method = OPTIONS) {
        add_header Access-Control-Allow-Origin "*";
        add_header Access-Control-Allow-Methods "GET, POST, OPTIONS, DELETE, PUT, PATCH";
        add_header Access-Control-Allow-Headers "Authorization, Content-Type";
        add_header Access-Control-Allow-Credentials "true";
        return 204;
    }
}